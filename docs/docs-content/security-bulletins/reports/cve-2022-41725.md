---
sidebar_label: "CVE-2022-41725"
title: "CVE-2022-41725"
description: "Lifecycle of CVE-2022-41725"
hide_table_of_contents: true
sidebar_class_name: "hide-from-sidebar"
toc_max_heading_level: 2
tags: ["security", "cve"]
---

## CVE Details

[CVE-2022-41725](https://nvd.nist.gov/vuln/detail/CVE-2022-41725)

## Last Update

11/7/2024

## NIST CVE Summary

A denial of service is possible from excessive resource consumption in net/http and mime/multipart. Multipart form
parsing with mime/multipart.Reader.ReadForm can consume largely unlimited amounts of memory and disk files. This also
affects form parsing in the net/http package with the Request methods FormFile, FormValue, ParseMultipartForm, and
PostFormValue. ReadForm takes a maxMemory parameter, and is documented as storing "up to maxMemory bytes +10MB (reserved
for non-file parts) in memory". File parts which cannot be stored in memory are stored on disk in temporary files. The
unconfigurable 10MB reserved for non-file parts is excessively large and can potentially open a denial of service vector
on its own. However, ReadForm did not properly account for all memory consumed by a parsed form, such as map entry
overhead, part names, and MIME headers, permitting a maliciously crafted form to consume well over 10MB. In addition,
ReadForm contained no limit on the number of disk files created, permitting a relatively small request body to create a
large number of disk temporary files. With fix, ReadForm now properly accounts for various forms of memory overhead, and
should now stay within its documented limit of 10MB + maxMemory bytes of memory consumption. Users should still be aware
that this limit is high and may still be hazardous. In addition, ReadForm now creates at most one on-disk temporary
file, combining multiple form parts into a single temporary file. The mime/multipart.File interface type's documentation
states, "If stored on disk, the File's underlying concrete type will be an \*os.File.". This is no longer the case when
a form contains more than one file part, due to this coalescing of parts into a single file. The previous behavior of
using distinct files for each form part may be reenabled with the environment variable GODEBUG=multipartfiles=distinct.
Users should be aware that multipart.ReadForm and the http.Request methods that call it do not limit the amount of disk
consumed by temporary files. Callers can limit the size of form data with http.MaxBytesReader.

## Our Official Summary

A denial-of-service vulnerability has been identified in the Go standard library affecting the mime/multipart package.
This vulnerability could allow an attacker to conduct a denial-of-service attack through excessive resource consumption
in net/http and mime/multipart. This vulnerability affects multiple 3rd party images. Images will be upgraded to newer
versions available.

## CVE Severity

[7.5](https://nvd.nist.gov/vuln/detail/CVE-2022-41725)

## Status

Ongoing

## Affected Products & Versions

- Palette VerteX airgap 4.4.18
- Palette VerteX 4.5.3, 4.5.8
- Palette Enterprise 4.5.3, 4.5.8

## Revision History

- 1.0 09/15/2024 Initial Publication
- 2.0 09/15/2024 Added palette VerteX airgap 4.4.18 to Affected Products
- 3.0 10/10/2024 CVE remediated in Palette VerteX airgap 4.5.3
- 4.0 10/14/2024 Added Palette Enterprise & Palette VerteX 4.5.3 to Affected Products
- 5.0 10/14/2024 Added Palette Enterprise & Palette VerteX 4.5.8 to Affected Products