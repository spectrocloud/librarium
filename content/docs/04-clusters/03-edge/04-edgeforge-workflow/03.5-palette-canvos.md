---
title: "Build Edge Artifacts"
metaTitle: "Build Edge Artifacts"
metaDescription: "Learn how to build installer ISO and provider OS images using Spectro Cloud's CanvOS utility."
icon: ""
hideToC: false
fullWidth: false
hideToCSidebar: false
hiddenFromNav: false
---

import Tabs from 'shared/components/ui/Tabs';
import WarningBox from 'shared/components/WarningBox';
import InfoBox from 'shared/components/InfoBox';
import PointsOfInterest from "shared/components/common/PointOfInterest";

# Build Edge Artifacts
Palette's Edge solution requires Edge hosts to be ready with the required dependencies and [user data](/clusters/edge/edge-configuration/installer-reference) configurations before deploying a Kubernetes cluster. An Edge host requires the following artifacts to prepare for successful cluster deployment:

<br />

* **Edge installer ISO image** - This bootable ISO image installs the necessary dependencies and configurations on a bare host machine. During installation, the host machine will boot from the Edge installer ISO, partition the disk, copy the image content to the disk, install the Palette Edge host agent and metadata, and perform several configuration steps. These configuration steps include registering the host with Palette, setting user privileges, and configuring network or security settings. 
<br />

* **Provider OS image** - This is a [Kairos](https://kairos.io/)-based image. This image installs an immutable Operating System (OS) and software dependencies compatible with a specific Kubernetes version at runtime, i.e., during the cluster deployment.  


In this guide, you will use Spectro Cloud's utility, [CanvOS](https://github.com/spectrocloud/CanvOS), to create an Edge installer ISO image and two provider OS images - one compatible with K3s v1.24.6 and another compatible with K3s v1.25.2. It builds two provider OS images, so you can use either of them that matches the Kubernetes version in your cluster profile.


The diagram below shows the high-level steps to build the artifacts and push the provider OS images to an image registry.



![Overarching diagram showing the workflow in the current guide.](/tutorials/palette-canvos/clusters_edge_palette-canvos_artifacts.png)




This guide presents two workflows - Basic and Advanced. 

The basic workflow has minimal customizations and offers a quick start to build Edge artifacts. This workflow builds an Ubuntu based Edge installer ISO and provider OS images. It will also push the provider OS images to the default image registry, *ttl.sh*. 

The advanced workflow uses more customization options. This workflow builds an openSUSE based Edge installer ISO and provider OS images. It will push the provider OS images to your Docker Hub image registry. 

You can follow either of the workflows below that suits your use case.
<br /> <br />

<Tabs>

<Tabs.TabPane tab="Basic" key="basic_create_artifacts">


# Prerequisites
To complete this basic guide, you will need the following items:
<br/>

* A physical or virtual Linux machine with *AMD64* (also known as *x86_64*) processor architecture. You can issue the following command in the terminal to check your processor architecture. 
  <br/>

  ```bash
  uname -m
  ```

* Minimum hardware configuration of the Linux machine:
  - 4 CPU
  - 8 GB memory
  - 50 GB storage
 

* [Git](https://cli.github.com/manual/installation). You can ensure git installation by issuing the `git --version` command.


* [Docker Engine](https://docs.docker.com/engine/install/) version 18.09.x or later. You can use the `docker --version` command to view the existing Docker version. You should have root-level or `sudo` privileges on your Linux machine to create privileged containers.   


* A [Spectro Cloud](https://console.spectrocloud.com) account. If you have not signed up, you can sign up for a [free trial](https://www.spectrocloud.com/free-tier/).


* Palette registration token for pairing Edge hosts with Palette. You will need tenant admin access to Palette to generate a new registration token. For detailed instructions, refer to the [Create Registration Token](/clusters/edge/site-deployment/site-installation/create-registration-token) guide.


# Instructions

Use the following instructions on your Linux machine to create all the required Edge artifacts quickly. 
<br />

1. Check out the [CanvOS](https://github.com/spectrocloud/CanvOS.git) GitHub repository containing the starter code. 
  <br />

  ```bash
  git clone https://github.com/spectrocloud/CanvOS.git
  ```


2. Change to the **CanvOS/** directory. 
  <br />

  ```bash
  cd CanvOS
  ```


3. View the available [git tags](https://github.com/spectrocloud/CanvOS/tags).
<br />

  ```bash
  git tags
  ```


4. Check out the repository tag that matches your Palette product version. Your Palette product version is displayed in the top left corner, as shown in the screenshot below. 

  ![Screenshot displaying the Palette product version.](/tutorials/palette-canvos/clusters_edge_palette-canvos_palette-version.png)

  You must check out a matching git tag so the Edge installer you generate will be compatible with your Palette product version. This guide uses **v3.4.3** tag as an example. 
  <br />

  ```shell
  git checkout v3.4.3
  ```


5. Review the files relevant for this guide. 
    - **.arg.template** - A sample **.arg** file that defines arguments to use during the build process. 
    - **Dockerfile** - Embeds the arguments and other configurations in the image.
    - **Earthfile** - Contains a series of commands to create target artifacts.
    - **earthly.sh** - Script to invoke the Earthfile, and generate target artifacts.
    - **user-data.template** - A sample user-data file.
  <br />


6. Issue the command below to save a custom image tag for the provider OS images in the `CUSTOM_TAG` variable. This guide uses `palette-learn` as an example. However, you can assign any lowercase and alphanumeric string to the `CUSTOM_TAG` variable. 
<br />

  ```bash
  export CUSTOM_TAG=palette-learn
  ```
  <br />

7. Issue the command below to create the **.arg** file with the custom tag. It uses the default values for the remaining variables. You can refer to the existing **.arg.template** file in the present working directory to know the variables you can customize.  
<br />

  ```bash
  cat << EOF > .arg
  CUSTOM_TAG=$CUSTOM_TAG
  IMAGE_REGISTRY=ttl.sh
  OS_DISTRIBUTION=ubuntu
  IMAGE_REPO=$OS_DISTRIBUTION
  OS_VERSION=22
  K8S_DISTRIBUTION=k3s
  ISO_NAME=palette-edge-installer
  EOF
  ```
  
  View the newly created file to ensure the customized variables are set correctly.
  <br />

  ```bash
  cat .arg
  ```
  <br />

8. Issue the command below to save your registration token to a local variable. Replace `[your_token_here]` with your actual registration token. 
<br />

  ```bash
  export token=[your_token_here]
  ```
  <br />
  
9. Issue the command below to create the **user-data** file that includes the tenant registration token. Also, you can click on the *Points of Interest* numbers below to learn more about the main attributes relevant to this example. 
  <br />

  <PointsOfInterest
    points={[
      {
        x: 260,
        y: 187,
        label: 1,
        description: "Stores the registration token and lets the agent use the auto-registration functionality and authenticate with the provided token.",
        tooltipPlacement: "rightTop",
      },
      {
        x: 190,
        y: 262,
        label: 2,
        description: "Instructs the installer to turn the host machine off once the installation is complete.",
      },
      {
        x: 190,
        y: 340,
        label: 3,
        description: "Sets the login credentials for Edge hosts. The login credentials will allow you to SSH log into the edge host for debugging purposes.",
        tooltipPlacement: "rightTop",
      },
    ]}
  >

  ```shell
  cat << EOF > user-data
  #cloud-config
  stylus:
    site:
      edgeHostToken: $token
  install:
    poweroff: true
  users:
    - name: kairos
      passwd: kairos
  EOF
  ```

  </PointsOfInterest>
  <br />

  View the newly created user data file to ensure the token is set correctly.
<br />

  ```bash
  cat user-data
  ``` 
  <br />

10. CanvOS utility internally uses [Earthly](https://earthly.dev/) to build the target artifacts. Issue the following command to invoke the Earthly build. The `--PE_VERSION` option in the command below signifies the Palette product version to use, which refers to the git tag you checked out in the previous step. 
<br />

  ```bash
  sudo ./earthly.sh +build-all-images --PE_VERSION=$(git describe --abbrev=0 --tags)
  ```

  ```bash coloredLines=2-2
  # Output condensed for readability
  ===================== Earthly Build SUCCESS ===================== 
  Share your logs with an Earthly account (experimental)! Register for one at https://ci.earthly.dev.
  ```
  This command may take up to 15-20 minutes to finish depending on the resources of the host machine.
  <br />


11. List the Docker images to review the provider OS images created. By default, provider images for all the Edge-supported Kubernetes versions are created. You can identify the provider images by reviewing the image tag value you used in the  **.arg** file's `CUSTOM_TAG` variable. 
<br />

  ```shell
  docker images --filter=reference='*/*:*palette-learn'
  ```

  ```bash coloredLines=3-4
  # Output
  REPOSITORY        TAG                                IMAGE ID       CREATED         SIZE
  ttl.sh/ubuntu     k3s-1.25.2-v3.4.3-palette-learn    b3c4956ccc0a   6 minutes ago   2.49GB
  ttl.sh/ubuntu     k3s-1.24.6-v3.4.3-palette-learn    fe1486da25df   6 minutes ago   2.49GB
  earthly/earthly   v0.7.4                             d771cc8edc38   2 weeks ago     333MB
  ```
  <br />


12. To use the provider OS images in your cluster profile, push them to the image registry mentioned in the **.arg** file. The current example and default behavior uses the [ttl.sh](https://ttl.sh/) image registry. This image registry is free to use and does not require a sign-up. Images pushed to *ttl.sh* are ephemeral and will expire after the 24 hrs time limit.  Use the following commands to push the provider OS image to the *ttl.sh* image registry.  
  <br />

  ```bash
  docker push ttl.sh/ubuntu:k3s-1.25.2-v3.4.3-palette-learn
  docker push ttl.sh/ubuntu:k3s-1.24.6-v3.4.3-palette-learn
  ```
  <br />

  <WarningBox>

  As a reminder, [ttl.sh](https://ttl.sh/) is a short-lived image registry. If you do not use these provider OS images in your cluster profile within 24 hours of pushing to *ttl.sh*, they will expire and must be re-pushed. Refer to the Advanced workflow in the current guide to learn how to use another registry, such as Docker Hub, and tag the docker images accordingly.

  </WarningBox>
  <br />


13. After pushing the provider images to the image registry, switch to Palette to create a cluster profile, and add the [BYOS Edge OS](/integrations/byoos) pack to the OS layer. Add the following custom content within your OS layer configuration's `options` attribute so that the cluster profile can pull the provider OS image from the image registry. 

  The following `system.xxxxx` attribute values should be as same as what you defined in the **.arg** file earlier. If you used customized arguments in the **.arg** file to build the Edge artifacts, change these attributes' values, as applicable to you, before using them in your cluster profile.
  <br />

  ```yaml
    system.uri: "{{ .spectro.pack.edge-native-byoi.options.system.registry }}/{{ .spectro.pack.edge-native-byoi.options.system.repo }}:{{ .spectro.pack.edge-native-byoi.options.system.k8sDistribution }}-{{ .spectro.system.kubernetes.version }}-{{ .spectro.pack.edge-native-byoi.options.system.peVersion }}-{{ .spectro.pack.edge-native-byoi.options.system.customTag }}"
    system.registry: ttl.sh
    system.repo: ubuntu
    system.k8sDistribution: k3s
    system.osName: ubuntu
    system.peVersion: v3.4.3
    system.customTag: palette-learn
    system.osVersion: 22
  ```
  The following screenshot illustrates how custom content has been incorporated into an OS layer of a cluster profile using the BYOS Edge OS pack.

  ![Screenshot of a sample cluster profile's OS layer ](/tutorials/palette-canvos/clusters_edge_palette-canvos_edit_profile.png)
  <br />

14. Add the Kubernetes layer to your cluster profile after updating the OS layer, and choose the **Palette Optimized K3s** pack. The current build process created provider OS images compatible with two Kubernetes versions - K3s v1.24.6 and K3s v1.25.2. Therefore, choose one of these versions for the **Palette Optimized K3s** pack. 


15. Lastly, add the Network layer to your cluster profile, and choose a Container Network Interface (CNI) pack that best fits your needs, such as Calico, Flannel, Cilium, or Custom CNI. 

  This step completes the core infrastructure layers in the cluster profile. Next, you can add add-on layers to your cluster profile. 



# Validate
List the Edge installer ISO image and checksum by issuing the following command from the **CanvOS/** directory.
<br />

```shell
ls build/
```

```shell
# Output
palette-edge-installer.iso      
palette-edge-installer.iso.sha256
```

You can validate the ISO image by creating a bootable USB flash drive using any third-party software and attempting to flash a bare host machine. Most software that creates a bootable USB drive will validate the ISO image. Here, the flash process means installing the necessary tools and configurations on a  host machine.

</Tabs.TabPane>

<Tabs.TabPane tab="Advanced" key="advanced_create_artifacts">


# Prerequisites
To complete this advanced guide, you will need the following items:
<br/>

* A physical or virtual Linux machine with *AMD64* (also known as *x86_64*) processor architecture. You can issue the following command in the terminal to check your processor architecture. 
  <br/>

  ```bash
  uname -m
  ```

* Minimum hardware configuration of the Linux machine:
  - 4 CPU
  - 8 GB memory
  - 50 GB storage
 

* [Git](https://cli.github.com/manual/installation). You can ensure git installation by issuing the `git --version` command.


* [Docker Engine](https://docs.docker.com/engine/install/) version 18.09.x or later. You can use the `docker --version` command to view the existing Docker version. You should have root-level or `sudo` privileges on your Linux machine to create privileged containers.   


* A [Spectro Cloud](https://console.spectrocloud.com) account. If you have not signed up, you can sign up for a [free trial](https://www.spectrocloud.com/free-tier/).


* Palette registration token for pairing Edge hosts with Palette. You will need tenant admin access to Palette to generate a new registration token. For detailed instructions, refer to the [Create Registration Token](/clusters/edge/site-deployment/site-installation/create-registration-token) guide.


* An account with [Docker Hub](https://hub.docker.com/). If you do not have an account with Docker Hub already, refer to the [Create an account](https://docs.docker.com/docker-id/) page for signing-up instructions. 
<br />

  <InfoBox>

  This guide uses Docker Hub as an example. You can use any other image registry that suit your requirements.

  </InfoBox>
  <br />

* A public repository named `opensuse-leap` in your image registry. Refer to the [Create a repository](https://docs.docker.com/docker-hub/repos/create/#create-a-repository) instructions for creating a Docker Hub repository and setting the repository's visibility to `public`. 


# Instructions

Use the following instructions on your Linux machine to customize the arguments and Dockerfile and create Edge artifacts.

<br />

1. Check out the [CanvOS](https://github.com/spectrocloud/CanvOS.git) GitHub repository containing the starter code. 
  <br />

  ```bash
  git clone https://github.com/spectrocloud/CanvOS.git
  ```


2. Change to the **CanvOS/** directory. 
  <br />

  ```bash
  cd CanvOS
  ```


3. View the available [git tags](https://github.com/spectrocloud/CanvOS/tags).
<br />

  ```bash
  git tags
  ```


4. Check out the repository tag that matches your Palette product version. Your Palette product version is displayed in the top left corner, as shown in the screenshot below. 

  ![Screenshot displaying the Palette product version.](/tutorials/palette-canvos/clusters_edge_palette-canvos_palette-version.png)

  You must check out a matching git tag so the Edge installer you generate will be compatible with your Palette product version. This guide uses **v3.4.3** tag as an example. 
  <br />

  ```shell
  git checkout v3.4.3
  ```
  <br />

5. Review the files relevant for this guide. 
    - **.arg.template** - A sample **.arg** file that defines arguments to use during the build process. 
    - **Dockerfile** - Embeds the arguments and other configurations in the image.
    - **Earthfile** - Contains a series of commands to create target artifacts.
    - **earthly.sh** - Script to invoke the Earthfile, and generate target artifacts.
    - **user-data.template** - A sample user-data file.
  <br />


6. Review the **.arg** file containing the customizable arguments, such as image tag, image registry, image repository, and OS distribution. The table below shows all arguments, their default value, and allowed values.

  |**Argument**|**Description**|**Default Value**| **Allowed Values** |
  |---|---|---|---|
  |`CUSTOM_TAG`|Tag for the provider images|demo|Lowercase alphanumeric string without spaces.|
  |`IMAGE_REGISTRY`|Image registry name|ttl.sh|Your image registry hostname, without `http` or `https` <br /> Example: docker.io/spectrocloud|
  |`OS_DISTRIBUTION`|OS Distribution |ubuntu | ubuntu, opensuse-leap|
  |`IMAGE_REPO`|Image repository name.<br /> It is the same as the OS distribution.|`$OS_DISTRIBUTION`|Your image repository name.|
  |`OS_VERSION`|OS version, only applies to Ubuntu |22| 20, 22|
  |`K8S_DISTRIBUTION`|Kubernetes Distribution |k3s| k3s, rke2, kubeadm |
  |`ISO_NAME`|Name of the Installer ISO|palette-edge-installer|Lowercase alphanumeric string without spaces. The charaters `-` and `_` are allowed. |

  Next, you will customize these variables to use during the build process. 
<br />

7. Issue the command below to save a custom image tag for the provider OS images in the `CUSTOM_TAG` variable. This guide uses `palette-learn` as an example. However, you can assign any lowercase and alphanumeric string to the `CUSTOM_TAG` variable. 
<br />

  ```bash
  export CUSTOM_TAG=palette-learn
  ```
  <br />

8. Issue the following command to save the Docker Hub image registry hostname in the `IMAGE_REGISTRY` variable. Before you execute the command, replace `[DOCKER-ID]` in the declaration below with your Docker ID. Your image registry hostname must comply with standard DNS rules and may not contain underscores. 
<br />

  ```bash
  export IMAGE_REGISTRY=docker.io/[DOCKER-ID]    # Follows [HOST]/[DOCKER-ID] syntax. Example: docker.io/spectrocloud
  ```
  <br />

9. Issue the following command to use the openSUSE Leap OS distribution. 
<br />

  ```bash
  export OS_DISTRIBUTION=opensuse-leap
  ``` 
  <br />

10. Issue the command below to create the **.arg** file with the custom tag, Docker Hub image registry hostname, and openSUSE Leap OS distribution. It uses the default values for the remaining variables. You can refer to the existing **.arg.template** file in the present working directory to know the variables you can customize.  
<br />

  ```bash
  cat << EOF > .arg
  IMAGE_REGISTRY=$IMAGE_REGISTRY
  OS_DISTRIBUTION=$OS_DISTRIBUTION
  IMAGE_REPO=$OS_DISTRIBUTION
  CUSTOM_TAG=$CUSTOM_TAG
  K8S_DISTRIBUTION=k3s
  ISO_NAME=palette-edge-installer
  EOF
  ```
  
  View the newly created file to ensure the customized variables are set correctly.
  <br />

  ```bash
  cat .arg
  ```
  <br />

  <WarningBox>

  Using the arguments defined in the **.arg** file, the final provider image name will have the following naming pattern, `[IMAGE_REGISTRY]/[IMAGE_REPO]:[CUSTOM_TAG]`. Ensure the final artifact name conforms to the Docker Hub image name syntax - `[HOST]/[DOCKER-ID]/[REPOSITORY]:[TAG]`. 

  </WarningBox>
  <br />

11. Issue the command below to append the instructions to install [WireGuard](https://www.wireguard.com/install/) to the Dockerfile. 
You can install more tools and dependencies and configure the image to meet your needs. Add your customizations below the line tagged with the `Add any other image customizations here` comment in the Dockerfile. Do not edit or add any lines before this tagged comment. 
  <br />

  ```bash
  echo 'RUN sudo zypper refresh && sudo zypper install -y wireguard-tools' >> Dockerfile
  ```

  View the newly created file to ensure the customized variables are set correctly.
  <br />

  ```bash
  cat Dockerfile
  ```
  <br />  
  <WarningBox>

  Using the `-y` option with the `sudo zypper install` command is critical to successfully build the images. The default behavior for package installations is to prompt the user for permission to install the package. A user prompt will cause the image ceration process to fail. This guidance applies to all dependencies you add through the **Dockerfile**. 

  </WarningBox>
  <br />

12. Issue the command below to save your registration token to a local variable. Replace `[your_token_here]` with your actual registration token. 
<br />

  ```bash
  export token=[your_token_here]
  ```
  <br />
  
13. Issue the command below to create the **user-data** file. Also, you can click on the *Points of Interest* numbers below to learn more about the main attributes relevant to this example. 
  <br />

  <PointsOfInterest
    points={[
      {
        x: 260,
        y: 187,
        label: 1,
        description: "Stores the registration token and lets the agent use the auto-registration functionality and authenticate with the provided token.",
        tooltipPlacement: "rightTop",
      },
      {
        x: 190,
        y: 262,
        label: 2,
        description: "Instructs the installer to turn the host machine off once the installation is complete.",
      },
      {
        x: 190,
        y: 340,
        label: 3,
        description: "Sets the login credentials for Edge hosts. The login credentials will allow you to SSH log into the edge host for debugging purposes.",
        tooltipPlacement: "rightTop",
      },
    ]}
  >

  ```shell
  cat << EOF > user-data
  #cloud-config
  stylus:
    site:
      edgeHostToken: $token
  install:
    poweroff: true
  users:
    - name: kairos
      passwd: kairos
  EOF
  ```

  </PointsOfInterest> 

  View the newly created user data file to ensure the token is set correctly.
<br />

  ```bash
  cat user-data
  ```
  
  If you want further customization, check the existing **user-data.template** file, and refer to the [Edge Configuration Stages](https://docs.spectrocloud.com/clusters/edge/edge-configuration/cloud-init#edgeconfigurationstages) and [User Data Parameters](https://docs-latest.spectrocloud.com/clusters/edge/edge-configuration/installer-reference) documents to learn more. 
  <br />

14. CanvOS utility internally uses [Earthly](https://earthly.dev/) to build the target artifacts. Issue the following command to invoke the Earthly build. The `--PE_VERSION` option in the command below signifies the Palette product version to use, which refers to the git tag you checked out in the previous step.
<br />

  ```bash
  sudo ./earthly.sh +build-all-images --PE_VERSION=$(git describe --abbrev=0 --tags)
  ```

  ```bash coloredLines=2-2
  # Output condensed for readability
  ===================== Earthly Build SUCCESS ===================== 
  Share your logs with an Earthly account (experimental)! Register for one at https://ci.earthly.dev.
  ```

  This command may take up to 15-20 minutes to finish depending on the resources of the host machine.
  <br />

15. List the Docker images to review the provider OS images created. By default, provider images for all the Edge-supported Kubernetes versions are created. You can identify the provider images by reviewing the image tag value you used in the  **.arg** file's `CUSTOM_TAG` variable. 
<br />

  ```shell
  docker images --filter=reference='*/*:*palette-learn'
  ```

  ```bash coloredLines=3-4
  # Output
  REPOSITORY                   TAG                               IMAGE ID       CREATED          SIZE
  spectrocloud/opensuse-leap   k3s-1.25.2-v3.4.3-palette-learn   2427e3667b2f   24 minutes ago   2.22GB
  spectrocloud/opensuse-leap   k3s-1.24.6-v3.4.3-palette-learn   0f2efd533a33   24 minutes ago   2.22GB
  earthly/earthly              v0.7.4                            d771cc8edc38   6 weeks ago      333MB
  ```
  <br />

16. To use the provider OS images in your cluster profile, push them to your image registry mentioned in the **.arg** file. Issue the following command to log in to Docker Hub. Provide your Docker ID and password when prompted.
<br />

  ```bash
  docker login
  ```

  ```bash
  # Output
  Login Succeeded
  ```
  <br />

17. Use the following commands to push the provider OS images to the Docker Hub image registry you specified. Replace the `[DOCKER-ID]` in the command below with your Docker ID. 
<br />

  ```bash
  docker push docker.io/[DOCKER-ID]/opensuse-leap:k3s-1.25.2-v3.4.3-palette-learn
  docker push docker.io/[DOCKER-ID]/opensuse-leap:k3s-1.24.6-v3.4.3-palette-learn
  ```
  <br />

18. After pushing the provider images to the image registry, switch to Palette to create a cluster profile, and add the [BYOS Edge OS](/integrations/byoos) pack to the OS layer. Add the following custom content within your OS layer configuration's `options` attribute so that the cluster profile can pull the provider OS image from the image registry. 

  The following `system.xxxxx` attribute values should be as same as what you defined in the **.arg** file earlier. If you used customized arguments in the **.arg** file to build the Edge artifacts, change these attributes' values, as applicable to you, before using them in your cluster profile.
  <br />

  ```yaml
    system.uri: "{{ .spectro.pack.edge-native-byoi.options.system.registry }}/{{ .spectro.pack.edge-native-byoi.options.system.repo }}:{{ .spectro.pack.edge-native-byoi.options.system.k8sDistribution }}-{{ .spectro.system.kubernetes.version }}-{{ .spectro.pack.edge-native-byoi.options.system.peVersion }}-{{ .spectro.pack.edge-native-byoi.options.system.customTag }}"
    system.registry: docker.io/spectrocloud
    system.repo: opensuse-leap
    system.k8sDistribution: k3s
    system.osName: opensuse-leap
    system.peVersion: v3.4.3
    system.customTag: palette-learn
  ```
  The following screenshot illustrates how custom content has been incorporated into an OS layer of a cluster profile using the BYOS Edge OS pack.

  ![Screenshot of a sample cluster profile's OS layer ](/tutorials/palette-canvos/clusters_edge_palette-canvos_edit_profile.png)
  <br />

19. Add the Kubernetes layer to your cluster profile after updating the OS layer, and choose the **Palette Optimized K3s** pack. The current build process created provider OS images compatible with two Kubernetes versions - K3s v1.24.6 and K3s v1.25.2. Therefore, choose one of these versions for the **Palette Optimized K3s** pack. 


20. Lastly, add the Network layer to your cluster profile, and choose a Container Network Interface (CNI) pack that best fits your needs, such as Calico, Flannel, Cilium, or Custom CNI. 

  This step completes the core infrastructure layers in the cluster profile. Next, you can add add-on layers to your cluster profile. 



# Validate

List the Edge installer ISO image and checksum by issuing the following command from the **CanvOS/** directory.
<br />

```shell
ls build/
```

```shell
# Output
palette-edge-installer.iso      
palette-edge-installer.iso.sha256
```

You can validate the ISO image by creating a bootable USB flash drive using any third-party software and attempting to flash a bare host machine. Most software that creates a bootable USB drive will also validate the ISO image. Here, the flash process means installing the necessary tools and configurations on a  host machine.


</Tabs.TabPane>

</Tabs>


# Next Steps

After building the Edge artifacts, the next step is creating a bootable USB flash drive using the installer ISO and a cluster profile for your Edge hosts. You will reference the provider OS images you uploaded to the image registry in the cluster profile. Check out the [Model Edge Cluster Profile](/clusters/edge/site-deployment/model-profile) guide to learn more about the next steps.
